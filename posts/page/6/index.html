<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | inosite</title>
<meta name=keywords content><meta name=description content="Posts - inosite"><meta name=author content><link rel=canonical href=https://inody.github.io/posts/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://inody.github.io/elephant.png><link rel=icon type=image/png sizes=16x16 href=https://inody.github.io/elephant.png><link rel=icon type=image/png sizes=32x32 href=https://inody.github.io/elephant.png><link rel=apple-touch-icon href=https://inody.github.io/elephant.png><link rel=mask-icon href=https://inody.github.io/elephant.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://inody.github.io/posts/index.xml><link rel=alternate hreflang=en href=https://inody.github.io/posts/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-9B4P13HJGR"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9B4P13HJGR",{anonymize_ip:!1})}</script><meta property="og:title" content="Posts"><meta property="og:description" content="This is my website"><meta property="og:type" content="website"><meta property="og:url" content="https://inody.github.io/posts/"><meta property="og:image" content="https://inody.github.io/47"><meta property="og:site_name" content="inosite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://inody.github.io/47"><meta name=twitter:title content="Posts"><meta name=twitter:description content="This is my website"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://inody.github.io/posts/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://inody.github.io/ accesskey=h title="🏠  (Alt + H)">🏠</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://inody.github.io/biography title="about me"><span>about me</span></a></li><li><a href=https://inody.github.io/research title=research><span>research</span></a></li><li><a href=https://inody.github.io/publication title=publications><span>publications</span></a></li><li><a href=https://inody.github.io/posts title=posts><span class=active>posts</span></a></li><li><a href=https://inody.github.io/search title="🔍 (Alt + /)" accesskey=/><span>🔍</span></a></li></ul></nav></header><main class=main><header class=page-header><h1>Posts</h1></header><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Langevin方程式とFokker-Planck方程式の対応</h2></header><div class=entry-content><p>$x(t)\in\mathbb R$の時間発展が、つぎの非線形ランジュバン方程式 $$ \dot x(t) = f(x(t)) + R(t) $$ で表されるとする。 ここで、$f:\mathbb R\to\mathbb R$は関数、$R:\mathbb R\to\mathbb R$はランダム力である。 $R(t)$はつぎの仮定を満たすとする。
$R(t)$はガウス過程。 すなわち、$t_1,\ldots,t_k$を選んだとき、$R(t_1,\ldots,t_k):=(R(t_1),\ldots,R(t_k))$が多次元正規分布に従う。 $\mathbb E[R(t)] = 0. $ $\mathbb E[R(t)R(t’)] = D\delta(t-t’)$, ただし$D$は正の定数。 $x(t)$と$R(t’)$が$t&lt;t’$で独立。 時刻$t$に$x(t)$が$[x,x+dx]$にある確率を$p(x,t)dx$と定義する。 $p(x,t)$を分布関数という。 $p(x,t)$はつぎの仮定を満たすとする。
$x\to\pm\infty$で$p(x,t)\to 0. $ $x\to\pm\infty$で$\frac{\partial p(x,t)}{\partial x}\to 0. $ このとき、$p(x,t)$はつぎのフォッカープランク方程式に従う。 $$ \frac{\partial p(x,t)}{\partial t} = \left( -\frac{\partial }{\partial x}f(x) + \frac{\partial^2}{\partial x^2}\frac{D}{2} \right) p(x,t) $$
証明はいろんなところに載ってる。 あとで追記するかも。</p></div><footer class=entry-footer><span title='2018-08-24 00:00:00 +0900 JST'>August 24, 2018</span></footer><a class=entry-link aria-label="post link to Langevin方程式とFokker-Planck方程式の対応" href=https://inody.github.io/posts/langevin-fokkerplanck/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>OpenCV/ArUcoライブラリで物体位置計測</h2></header><div class=entry-content><p>OpenCVは画像処理に触れたことのある人ならば知らない人はいないと言われるほど有名なライブラリですが、本日はそのモジュールの一つである、AR用ライブラリArUcoを用いて、物体の位置計測をしてみます。
ネットにはC++の記事がたくさん転がっているのですが、Pythonを用いた記事が少ないように感じたため、備忘録としてブログに残そうと思った次第です。
やりたいこと 机の上に座標系を設定し（横の辺が$x$軸、縦の辺が$y$軸とか）、机の上を動き回る物体（小型ロボットとか）の位置座標を、机を撮影するカメラの映像から推定したいです。
準備  PCにPythonはインストールされているとし、OpenCVのインストールから行います。
pip install opencv-contrib-python 動作確認を行いましょう。
import cv2 aruco = cv2.aruco help(aruco) それっぽい文章がわちゃわちゃ出てきたら、インストール成功です。
マーカー生成 ArUcoでは、QRコードのような2次元マーカーを生成し、画像中から生成されたマーカーを認識することができます。 画像の生成は以下のように行います。
dictionary = aruco.getPredefinedDictionary(aruco.DICT_4X4_50) for i in range(5): marker = aruco.drawMarker(dictionary, i+1, 100) cv2.imwrite('ar_marker'+str(i+1)+'.png', marker) ここで、getPredefinedDictionaryはマーカーが格納されている辞書を呼び出す関数であり、DICT_4X4_50は辞書の種類を表します。 また、forループの中では、drawMarkerでidが$i+1$のマーカーを呼び出し、imwriteで呼び出したマーカーを保存しています。
生成された画像はつぎのようになります。
今回マーカーは5つ呼び出しました。 1つは物体に設置し、認識するためのもので、残りの4つは座標変換のためのものです。
マーカー検出 画像中のマーカーを検出するためのコードが以下です。
img = cv2.imread('img.jpg') corners, ids, rejectedImgPoints = aruco.detectMarkers(img, dictionary) img_marked = aruco.drawDetectedMarkers(img, corners, ids) cv2.imwrite('img_marked.png', img_marked) detectMarkersで、画像からマーカーを認識します（たった一行！）。 戻り値であるcornersとidsは、それぞれ検出されたマーカーの座標とidが格納されたリストです。
先ほど生成された画像をモニタに表示させ、手元のカメラで撮影したものを認識させてみました。 結果がつぎのようになります。
座標変換 ArUcoでは、画像中のマーカーの位置を検出することができますが、その位置座標は机の上の座標と必ずしも一致しません。 このため、机の上に座標変換用のマーカーを設置し、それらを用いて座標変換を行うことにします。 この作業は、ArUcoではなく、OpenCVライブラリによって実現できます。
marker_coordinates = np.float32(moments) true_coordinates = np....</p></div><footer class=entry-footer><span title='2018-03-18 00:00:00 +0900 JST'>March 18, 2018</span></footer><a class=entry-link aria-label="post link to OpenCV/ArUcoライブラリで物体位置計測" href=https://inody.github.io/posts/opencv/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>デルタ関数とは、超関数とは</h2></header><div class=entry-content><p>デルタ関数って結局何なの？ 工学の至る所で現れるデルタ関数。これはよく $$ \delta(t):= \begin{cases} \infty, & t=0\\newline 0, & t\ne 0 \end{cases}, $$ $$ \int_\infty^\infty \delta(x-y)f(y)dy = f(x), $$ $$ \int_\infty^\infty \delta(t)dt = 1 $$ を満たす関数 $\delta$ という風に定義されていますが、「 $t=0$ は測度0なので、その積分は0になるのでは」と考えたことがある人は多いのではないでしょうか。 実はこの定義は不正確なものであり、「超関数」という概念によって、正確に定義することができます。
超関数の定義 ある数値を入力するとある数値を出力する装置のことを、関数といいます。 これに対して、ある関数を入力するとある複素数を出力するような装置のことを、汎関数といいます。 汎関数 $F$ に関数 $\phi$ を入力した時の出力値を $F[\phi]$ 、または $\langle F, \phi \rangle$ と書きます。以下では後者の書き方を用います。
全区間で無限回微分可能で、関数値が0でないところが有界区間に限られるような関数の全体からなる集合を $\mathcal D$ とします。 $\mathcal D$ 上に属する関数 $\phi$ をテスト関数と呼びます。 また、 $\mathcal D$ を定義域とする汎関数を $\mathcal D$ 上の汎関数と呼びます。
ここで、シュワルツの超関数は、つぎのように定義されます。
汎関数 $F$ が、
$\langle F, \phi_1 + \phi_2\rangle = \langle F, \phi_1\rangle + \langle F, \phi_2\rangle,$ $\langle F, c\phi\rangle = c\langle F, \phi\rangle\ (c\in\mathbb K),$ テスト関数の列 ${\phi_n}$ が $n\to\infty$ で $\phi$ に収束する時、 $\langle F, \phi_n\rangle$ もまた $\langle F, \phi\rangle$ に収束する を満たすとき、 $F$を超関数という。...</p></div><footer class=entry-footer><span title='2017-10-15 00:00:00 +0900 JST'>October 15, 2017</span></footer><a class=entry-link aria-label="post link to デルタ関数とは、超関数とは" href=https://inody.github.io/posts/generalized-function/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>カーネル型機械学習入門</h2></header><div class=entry-content><p>$d$個の数値を並べた変数$\mathbf{x}=(x_1,x_2,\ldots,x_d)^{\mathrm T}$から、 $y$という変数を推定する多変量の回帰問題を考えます。 サンプルデータは$n$組あるとし、$i$番目のサンプルを$\mathbf{x}^{(i)}, y^{(i)}$と書くことにします。
線形モデル まず、カーネルを使わない線形モデル
$$y = \mathbf w^\mathrm T \mathbf x$$
を考えましょう。これは、データを原点を通る直線で当てはめることを意味します。 直線からのズレに対して、損失を
$$r(y,\mathbf{x};\mathbf{w}) = (y-\mathbf w^\mathrm T \mathbf x)^2$$
として定義し、全てのサンプルの総和
$$R(\mathbf{w}) = \sum_{j=1}^n r(y,\mathbf{x};\mathbf{w})$$
を考えます。$R(\mathbf{w})$は
$$\mathbf y := \left( \begin{array}{ccc} y^{(1)}\newline y^{(2)}\newline \vdots\newline y^{(n)} \end{array} \right) $$ $$X := \left( \begin{array}{ccc} x_1^{(1)} & \cdots & x_d^{(1)}\newline x_1^{(2)} & \cdots & x_d^{(2)}\newline \vdots& & \vdots\newline x_1^{(n)} & \cdots & x_d^{(n)} \end{array} \right) $$
を用いて、
$$R(\mathbf{w})=(\mathbf y-X\mathbf w)^\mathrm T(\mathbf y-X\mathbf w)$$...</p></div><footer class=entry-footer><span title='2017-07-23 00:00:00 +0900 JST'>July 23, 2017</span></footer><a class=entry-link aria-label="post link to カーネル型機械学習入門" href=https://inody.github.io/posts/kernel-machine-learning/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>日経平均株価をLSTMを用いて予測してみた</h2></header><div class=entry-content><p>概要 今流行りの深層学習で日経平均株価を予想してみました。 結論から言えば、全く予想できず、惨敗でした。
LSTMとは LSTMとはリカレントニューラルネットワーク（RNN）と呼ばれる機械学習手法の一つです。 RNNを用いることで、現在と過去一定時間の時系列データから、未来のデータを予測することができます。 また、RNNを改良したLSTMでは、長期のトレンドが反映されやすいとされています。
詳しくはこちらのサイトをご覧ください。
学習データとかモデルとか こちらのサイトから、過去4ヶ月の1時間足のデータをダウンロードし、学習データとして用いました。 モデルの隠れ層のユニット数は100、過去20時間の株価から1時間先の株価を予測するモデルを用いました。学習方法はAdamを用いました。
実装 Keras(TensorFlow)を用いて実装しました。初めて使ったんですが、短く書けて便利ですね。以下、ソースコードを載せておきます。
# coding: utf-8 import numpy as np from keras.models import Sequential from keras.layers import Dense, Activation from keras.layers.recurrent import LSTM from keras.optimizers import Adam from keras.initializers import TruncatedNormal from keras.callbacks import EarlyStopping from sklearn.model_selection import train_test_split import matplotlib.pyplot as plt import seaborn import pandas as pd df = pd.read_csv('~/deep_learning/csv/nikkei4_7.csv') x = df['始値'] / df['始値'].max() f = list(x) length_of_sequences = len(f) maxlen = 20 data = [] target = [] for i in range(0, length_of_sequences - maxlen): data....</p></div><footer class=entry-footer><span title='2017-07-16 00:00:00 +0900 JST'>July 16, 2017</span></footer><a class=entry-link aria-label="post link to 日経平均株価をLSTMを用いて予測してみた" href=https://inody.github.io/posts/lstm-market/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://inody.github.io/posts/page/5/>«&nbsp;Prev&nbsp;
</a><a class=next href=https://inody.github.io/posts/page/7/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2024 <a href=https://inody.github.io/>inosite</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>